UNITS NATURAL
RESTART
FLUSH STRIDE=500

FCCUBIC ...
LABEL=fcc
SPECIES=1-315392
SWITCH={CUBIC D_0=1.2 D_MAX=1.5}
ALPHA=27
PHI=0.0 THETA=1.5708 PSI=0.785398 # angles for which Z // <110> directions
MORE_THAN1={SMAP R_0=0.45 D_0=0.0 A=8 B=8}
LOWMEM
... FCCUBIC

RESTRAINT ARG=fcc.morethan-1 AT=96000 KAPPA=0.0003 LABEL=res

PRINT STRIDE=10 ARG=fcc.*,res.bias FILE=COLVAR

smapfcc: MTRANSFORM_MORE DATA=fcc SWITCH={SMAP R_0=0.45 D_0=0.0 A=8 B=8} LOWMEM
center: CENTER_OF_MULTICOLVAR DATA=fcc
DUMPMULTICOLVAR DATA=fcc FILE=fcc.xyz ORIGIN=center STRIDE=500
DUMPMULTICOLVAR DATA=smapfcc FILE=smapfcc.xyz ORIGIN=center STRIDE=500

ENDPLUMED

# Field
dens1: MULTICOLVARDENS DATA=smapfcc ORIGIN=center DIR=xyz NBINS=80,80,80 BANDWIDTH=1.0,1.0,1.0 LOWMEM STRIDE=500 CLEAR=500 ZREDUCED ZLOWER=0.0 ZUPPER=20.0
#DUMPCUBE GRID=dens1 FILE=dens1.cube STRIDE=500
# Contour
contour1: FIND_CONTOUR_SURFACE GRID=dens1 CONTOUR=0.5 SEARCHDIR=z STRIDE=500 CLEAR=500
DUMPGRID GRID=contour1 FILE=contour1.dat STRIDE=500
#GRID_TO_XYZ GRID=contour1 FILE=contour1.xyz STRIDE=100


# Field
dens2: MULTICOLVARDENS DATA=smapfcc ORIGIN=center DIR=xyz NBINS=80,80,80 BANDWIDTH=1.0,1.0,1.0 LOWMEM STRIDE=500 CLEAR=500 ZREDUCED ZLOWER=-20.0 ZUPPER=0.0
#DUMPCUBE GRID=dens2 FILE=dens2.cube STRIDE=500
# Contour
contour2: FIND_CONTOUR_SURFACE GRID=dens2 CONTOUR=0.5 SEARCHDIR=z STRIDE=500 CLEAR=500
DUMPGRID GRID=contour2 FILE=contour2.dat STRIDE=500
#GRID_TO_XYZ GRID=contour2 FILE=contour2.xyz STRIDE=100

# FT
ft1: FOURIER_TRANSFORM GRID=contour1 FT_TYPE=complex FOURIER_PARAMETERS=-1,1 STRIDE=500 CLEAR=500
ft_grid1: DUMPGRID GRID=ft1 FILE=fourier1.dat FMT=%8.6e STRIDE=500
ft2: FOURIER_TRANSFORM GRID=contour2 FT_TYPE=complex FOURIER_PARAMETERS=-1,1 STRIDE=500 CLEAR=500
ft_grid2: DUMPGRID GRID=ft2 FILE=fourier2.dat FMT=%8.6e STRIDE=500


